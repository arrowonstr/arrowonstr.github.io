<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>编译原理实践—python构建编译器 | 弦上的箭</title>
  <meta name="keywords" content=" 编译原理 , 编译器 ">
  <meta name="description" content="编译原理实践—python构建编译器 | 弦上的箭">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="简介：&amp;emsp;&amp;emsp;本项目用于为指定语句编写编译器和解释器，除了编译原理基础概念，本项目其它算法都为原创  一、项目要求为五种语句编写编译器和解释器 1. 循环绘图语句 2. 比例设置语句 3. 坐标平移语句 4. 角度旋转语句 5. 注释语句 6. 程序演示 二、词法分析1. DFA设计如图：其中0是初态，其余都是终态其中每个状态的含义为：ERROR&#x3D;0  ID&#x3D;">
<meta property="og:type" content="article">
<meta property="og:title" content="编译原理实践—python构建编译器">
<meta property="og:url" content="http://example.com/2024/01/03/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E5%AE%9E%E8%B7%B5%E2%80%94python%E6%9E%84%E5%BB%BA%E7%BC%96%E8%AF%91%E5%99%A8/index.html">
<meta property="og:site_name" content="弦上的箭">
<meta property="og:description" content="简介：&amp;emsp;&amp;emsp;本项目用于为指定语句编写编译器和解释器，除了编译原理基础概念，本项目其它算法都为原创  一、项目要求为五种语句编写编译器和解释器 1. 循环绘图语句 2. 比例设置语句 3. 坐标平移语句 4. 角度旋转语句 5. 注释语句 6. 程序演示 二、词法分析1. DFA设计如图：其中0是初态，其余都是终态其中每个状态的含义为：ERROR&#x3D;0  ID&#x3D;">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/imgs/compilerProject/1703406969131.jpg">
<meta property="og:image" content="http://example.com/imgs/compilerProject/1703407011813.jpg">
<meta property="og:image" content="http://example.com/imgs/compilerProject/1703407079046.jpg">
<meta property="og:image" content="http://example.com/imgs/compilerProject/1703407127151.jpg">
<meta property="og:image" content="http://example.com/imgs/compilerProject/1703407220618.jpg">
<meta property="og:image" content="http://example.com/imgs/compilerProject/1703407388728.jpg">
<meta property="og:image" content="http://example.com/imgs/123124.png">
<meta property="og:image" content="http://example.com/imgs/compilerProject/1703432926195.jpg">
<meta property="article:published_time" content="2024-01-03T15:54:24.000Z">
<meta property="article:modified_time" content="2024-01-03T15:56:42.556Z">
<meta property="article:author" content="弦上的箭">
<meta property="article:tag" content="编译原理">
<meta property="article:tag" content="编译器">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/imgs/compilerProject/1703406969131.jpg">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 6.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>弦上的箭</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/arrowonstr"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:21009200039@stu.xidian.edu.cn"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(18)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="项目">
            <i class="fold iconfont icon-right"></i>
            项目
            <small>(10)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="项目&lt;---&gt;程序设计">
            <i class="fold iconfont icon-right"></i>
            程序设计
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="项目&lt;---&gt;程序设计&lt;---&gt;会议室系统">
            
            会议室系统
            <small>(2)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
                    
    <li>
        <div data-rel="项目&lt;---&gt;嵌入式">
            <i class="fold iconfont icon-right"></i>
            嵌入式
            <small>(7)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="项目&lt;---&gt;嵌入式&lt;---&gt;K210">
            
            K210
            <small>(7)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="笔记">
            <i class="fold iconfont icon-right"></i>
            笔记
            <small>(6)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="笔记&lt;---&gt;课程">
            
            课程
            <small>(4)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="笔记&lt;---&gt;人工智能">
            <i class="fold iconfont icon-right"></i>
            人工智能
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="笔记&lt;---&gt;人工智能&lt;---&gt;yolo">
            
            yolo
            <small>(2)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="日记">
            
            日记
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
        <a 
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="18">
<input type="hidden" id="yelog_site_word_count" value="47.4k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://gohoy.github.io/blog">GOHOY</a></li>
            
            <li><a target="_blank" href="https://blog.dx39061.top">DX3906</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>编译器</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>编译原理</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>计算机组成原理</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>计网</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>目标检测</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>日记</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>数据库</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>K210</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>qt</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sql</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a id="top" class="All 日记 "
           href="/2023/09/15/%E5%B0%81%E9%9D%A2/"
           data-tag="日记"
           data-author="" >
            <span class="post-title" title="封面">封面</span>
            <span class="post-date" title="2023-09-15 15:00:00">2023/09/15</span>
        </a>
        
        
        <a  class="All 项目 "
           href="/2024/01/03/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E5%AE%9E%E8%B7%B5%E2%80%94python%E6%9E%84%E5%BB%BA%E7%BC%96%E8%AF%91%E5%99%A8/"
           data-tag="编译原理,编译器"
           data-author="" >
            <span class="post-title" title="编译原理实践—python构建编译器">编译原理实践—python构建编译器</span>
            <span class="post-date" title="2024-01-03 23:54:24">2024/01/03</span>
        </a>
        
        
        <a  class="All 笔记 课程 "
           href="/2023/12/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0/"
           data-tag="计网"
           data-author="" >
            <span class="post-title" title="计算机网络笔记">计算机网络笔记</span>
            <span class="post-date" title="2023-12-14 21:58:14">2023/12/14</span>
        </a>
        
        
        <a  class="All 笔记 课程 "
           href="/2023/11/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0/"
           data-tag="数据库"
           data-author="" >
            <span class="post-title" title="数据库笔记">数据库笔记</span>
            <span class="post-date" title="2023-11-24 15:26:00">2023/11/24</span>
        </a>
        
        
        <a  class="All 笔记 课程 "
           href="/2023/11/24/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86II%E7%AC%94%E8%AE%B0/"
           data-tag="计算机组成原理"
           data-author="" >
            <span class="post-title" title="计算机组成原理II笔记">计算机组成原理II笔记</span>
            <span class="post-date" title="2023-11-24 15:26:00">2023/11/24</span>
        </a>
        
        
        <a  class="All 笔记 课程 "
           href="/2023/11/24/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E7%AC%94%E8%AE%B0/"
           data-tag="编译原理"
           data-author="" >
            <span class="post-title" title="编译原理笔记">编译原理笔记</span>
            <span class="post-date" title="2023-11-24 15:26:00">2023/11/24</span>
        </a>
        
        
        <a  class="All 笔记 人工智能 yolo "
           href="/2023/10/30/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E7%AE%97%E6%B3%95Yolo-%E4%BA%8C-%E2%80%94YoloV1V2%E5%8E%9F%E7%90%86%E5%8F%8A%E6%BA%90%E7%A0%81%E4%BD%BF%E7%94%A8/"
           data-tag="目标检测"
           data-author="" >
            <span class="post-title" title="目标检测算法Yolo(二)—YoloV1V2原理及源码使用">目标检测算法Yolo(二)—YoloV1V2原理及源码使用</span>
            <span class="post-date" title="2023-10-30 11:46:34">2023/10/30</span>
        </a>
        
        
        <a  class="All 笔记 人工智能 yolo "
           href="/2023/10/30/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E7%AE%97%E6%B3%95Yolo-%E4%B8%80-%E2%80%94%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AEPytorch/"
           data-tag="目标检测"
           data-author="" >
            <span class="post-title" title="目标检测算法Yolo(一)—环境配置Pytorch">目标检测算法Yolo(一)—环境配置Pytorch</span>
            <span class="post-date" title="2023-10-30 11:25:33">2023/10/30</span>
        </a>
        
        
        <a  class="All 项目 程序设计 会议室系统 "
           href="/2023/10/29/%E4%BC%9A%E8%AE%AE%E5%AE%A4%E9%A2%84%E7%BA%A6%E7%B3%BB%E7%BB%9F-%E4%B8%80-%E2%80%94QT%E5%BC%80%E5%8F%91%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0/"
           data-tag="qt,sql"
           data-author="" >
            <span class="post-title" title="会议室预约系统(一)—QT开发数据库学习">会议室预约系统(一)—QT开发数据库学习</span>
            <span class="post-date" title="2023-10-29 23:16:04">2023/10/29</span>
        </a>
        
        
        <a  class="All 项目 程序设计 会议室系统 "
           href="/2023/10/29/%E4%BC%9A%E8%AE%AE%E5%AE%A4%E9%A2%84%E7%BA%A6%E7%B3%BB%E7%BB%9F-%E4%BA%8C-%E2%80%94%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/"
           data-tag="qt,sql"
           data-author="" >
            <span class="post-title" title="会议室预约系统(二)—代码实现">会议室预约系统(二)—代码实现</span>
            <span class="post-date" title="2023-10-29 22:53:54">2023/10/29</span>
        </a>
        
        
        <a  class="All 项目 嵌入式 K210 "
           href="/2023/09/23/K210%E5%BC%80%E5%8F%91%E6%9D%BF-%E5%85%AD-yolo%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/"
           data-tag="K210"
           data-author="" >
            <span class="post-title" title="K210开发板(六)-yolo目标检测">K210开发板(六)-yolo目标检测</span>
            <span class="post-date" title="2023-09-23 16:28:11">2023/09/23</span>
        </a>
        
        
        <a  class="All 项目 嵌入式 K210 "
           href="/2023/09/19/K210%E5%BC%80%E5%8F%91%E6%9D%BF-%E4%BA%94-%E2%80%94%E6%8B%8D%E6%91%84%E5%92%8CKEYPAD%E7%85%A7%E7%89%87%E6%9F%A5%E7%9C%8B/"
           data-tag="K210"
           data-author="" >
            <span class="post-title" title="K210开发板(五)—拍摄和KEYPAD照片查看">K210开发板(五)—拍摄和KEYPAD照片查看</span>
            <span class="post-date" title="2023-09-19 00:16:58">2023/09/19</span>
        </a>
        
        
        <a  class="All 项目 嵌入式 K210 "
           href="/2023/09/17/K210%E5%BC%80%E5%8F%91%E6%9D%BF-%E5%9B%9B-%E2%80%94%E6%8C%89%E9%94%AE%E7%8B%AC%E7%AB%8B%E4%B8%AD%E6%96%AD/"
           data-tag="K210"
           data-author="" >
            <span class="post-title" title="K210开发板(四)—按键独立中断">K210开发板(四)—按键独立中断</span>
            <span class="post-date" title="2023-09-17 18:20:11">2023/09/17</span>
        </a>
        
        
        <a  class="All 项目 嵌入式 K210 "
           href="/2023/09/16/K210%E5%BC%80%E5%8F%91%E6%9D%BF-%E4%B8%89-%E2%80%94%E6%89%AC%E5%A3%B0%E5%99%A8%E6%92%AD%E6%94%BE/"
           data-tag="K210"
           data-author="" >
            <span class="post-title" title="K210开发板(三)—扬声器播放">K210开发板(三)—扬声器播放</span>
            <span class="post-date" title="2023-09-16 22:59:34">2023/09/16</span>
        </a>
        
        
        <a  class="All 项目 嵌入式 K210 "
           href="/2023/09/16/K210%E5%BC%80%E5%8F%91%E6%9D%BF-%E4%BA%8C-%E2%80%94%E7%82%B9%E4%BA%AELED%E7%81%AF/"
           data-tag="K210"
           data-author="" >
            <span class="post-title" title="K210开发板(二)—点亮LED灯">K210开发板(二)—点亮LED灯</span>
            <span class="post-date" title="2023-09-16 13:40:42">2023/09/16</span>
        </a>
        
        
        <a  class="All 项目 嵌入式 K210 "
           href="/2023/09/15/K210%E5%BC%80%E5%8F%91%E6%9D%BF-%E4%B8%80-%E2%80%94%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"
           data-tag="K210"
           data-author="" >
            <span class="post-title" title="K210开发板(一)—搭建开发环境">K210开发板(一)—搭建开发环境</span>
            <span class="post-date" title="2023-09-15 21:53:59">2023/09/15</span>
        </a>
        
        
        <a  class="All 项目 嵌入式 K210 "
           href="/2023/09/15/K210%E5%BC%80%E5%8F%91%E6%9D%BF-%E9%9B%B6/"
           data-tag="K210"
           data-author="" >
            <span class="post-title" title="K210开发板(零)">K210开发板(零)</span>
            <span class="post-date" title="2023-09-15 18:44:02">2023/09/15</span>
        </a>
        
        
        <a  class="All 日记 "
           href="/2023/09/15/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"
           data-tag="日记"
           data-author="" >
            <span class="post-title" title="我的第一篇博客">我的第一篇博客</span>
            <span class="post-date" title="2023-09-15 15:44:02">2023/09/15</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-编译原理实践—python构建编译器" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">编译原理实践—python构建编译器</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="项目">项目</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color5">编译原理</a>
            
            <a class="color4">编译器</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2024-01-03 23:56:42'>2024-01-03 23:54</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:3.4k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views 👀 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E9%A1%B9%E7%9B%AE%E8%A6%81%E6%B1%82"><span class="toc-text">一、项目要求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BE%AA%E7%8E%AF%E7%BB%98%E5%9B%BE%E8%AF%AD%E5%8F%A5"><span class="toc-text">1. 循环绘图语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%AF%94%E4%BE%8B%E8%AE%BE%E7%BD%AE%E8%AF%AD%E5%8F%A5"><span class="toc-text">2. 比例设置语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%9D%90%E6%A0%87%E5%B9%B3%E7%A7%BB%E8%AF%AD%E5%8F%A5"><span class="toc-text">3. 坐标平移语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%A7%92%E5%BA%A6%E6%97%8B%E8%BD%AC%E8%AF%AD%E5%8F%A5"><span class="toc-text">4. 角度旋转语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%B3%A8%E9%87%8A%E8%AF%AD%E5%8F%A5"><span class="toc-text">5. 注释语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E7%A8%8B%E5%BA%8F%E6%BC%94%E7%A4%BA"><span class="toc-text">6. 程序演示</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90"><span class="toc-text">二、词法分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-DFA"><span class="toc-text">1. DFA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8"><span class="toc-text">2. 词法分析器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3"><span class="toc-text">2.1 问题与解决</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E8%BE%93%E5%85%A5"><span class="toc-text">2.2 输入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E5%B7%A5%E4%BD%9C%E7%BB%86%E8%8A%82"><span class="toc-text">2.3 工作细节</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E8%BE%93%E5%87%BA"><span class="toc-text">2.4 输出</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90"><span class="toc-text">三、语法分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%8A%E4%B8%8B%E6%96%87%E6%97%A0%E5%85%B3%E6%B3%95"><span class="toc-text">1. 上下文无关法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8"><span class="toc-text">2. 语法分析器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3-1"><span class="toc-text">2.1 问题与解决</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-text">问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%94%B9%E8%BF%9B%E6%80%9D%E6%83%B3"><span class="toc-text">改进思想</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E7%AE%97%E6%B3%95"><span class="toc-text">最终算法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E8%BE%93%E5%85%A5-1"><span class="toc-text">2.2 输入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E5%B7%A5%E4%BD%9C%E7%BB%86%E8%8A%82-1"><span class="toc-text">2.3 工作细节</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E8%BE%93%E5%87%BA-1"><span class="toc-text">2.4 输出</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E8%AF%AD%E4%B9%89%E5%88%86%E6%9E%90"><span class="toc-text">四、语义分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3"><span class="toc-text">1. 问题与解决</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BF%BB%E8%AF%91%E5%99%A8"><span class="toc-text">2. 翻译器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E8%BE%93%E5%85%A5"><span class="toc-text">2.1 输入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E5%B7%A5%E4%BD%9C%E7%BB%86%E8%8A%82"><span class="toc-text">2.2 工作细节</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E8%BE%93%E5%87%BA"><span class="toc-text">2.3 输出</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA"><span class="toc-text">五、结果展示</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-4 i,
    .toc-level-4 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<p><span style="color: gray;">简介：<br>&emsp;&emsp;本项目用于为指定语句编写编译器和解释器，除了编译原理基础概念，本项目其它算法都为原创</span></p>
<hr>
<h2 id="一、项目要求"><a href="#一、项目要求" class="headerlink" title="一、项目要求"></a>一、项目要求</h2><p>为五种语句编写编译器和解释器</p>
<h3 id="1-循环绘图语句"><a href="#1-循环绘图语句" class="headerlink" title="1. 循环绘图语句"></a>1. 循环绘图语句</h3><p><img src="/imgs/compilerProject/1703406969131.jpg" alt="图片"></p>
<h3 id="2-比例设置语句"><a href="#2-比例设置语句" class="headerlink" title="2. 比例设置语句"></a>2. 比例设置语句</h3><p><img src="/imgs/compilerProject/1703407011813.jpg" alt="图片"></p>
<h3 id="3-坐标平移语句"><a href="#3-坐标平移语句" class="headerlink" title="3. 坐标平移语句"></a>3. 坐标平移语句</h3><p><img src="/imgs/compilerProject/1703407079046.jpg" alt="图片"></p>
<h3 id="4-角度旋转语句"><a href="#4-角度旋转语句" class="headerlink" title="4. 角度旋转语句"></a>4. 角度旋转语句</h3><p><img src="/imgs/compilerProject/1703407127151.jpg" alt="图片"></p>
<h3 id="5-注释语句"><a href="#5-注释语句" class="headerlink" title="5. 注释语句"></a>5. 注释语句</h3><p><img src="/imgs/compilerProject/1703407220618.jpg" alt="图片"></p>
<h3 id="6-程序演示"><a href="#6-程序演示" class="headerlink" title="6. 程序演示"></a>6. 程序演示</h3><p><img src="/imgs/compilerProject/1703407388728.jpg" alt="图片"></p>
<h2 id="二、词法分析"><a href="#二、词法分析" class="headerlink" title="二、词法分析"></a>二、词法分析</h2><h3 id="1-DFA"><a href="#1-DFA" class="headerlink" title="1. DFA"></a>1. DFA</h3><p>设计如图：<br><img src="/imgs/123124.png" alt="图片"><br>其中0是初态，其余都是终态<br>其中每个状态的含义为：<br>ERROR&#x3D;0  ID&#x3D;1  CONST_ID&#x3D;2<br>CONST_FLOAT_ID&#x3D;3  MUL&#x3D;4  POWER&#x3D;5<br>MINUS&#x3D;6  NOTE&#x3D;7  DIV&#x3D;8<br>PLUS&#x3D;9  L_BRACKET&#x3D;10  R_BRACKET&#x3D;11<br>COMMA&#x3D;12  SEMICOLON&#x3D;13  T&#x3D;14<br>ORIGIN&#x3D;15  SCALE&#x3D;16  ROT&#x3D;17<br>IS&#x3D;18  FOR&#x3D;19  FROM&#x3D;20<br>TO&#x3D;21  STEP&#x3D;22  DRAW&#x3D;23<br>FUNC&#x3D;24  EOF&#x3D;25</p>
<h3 id="2-词法分析器"><a href="#2-词法分析器" class="headerlink" title="2. 词法分析器"></a>2. 词法分析器</h3><h4 id="2-1-问题与解决"><a href="#2-1-问题与解决" class="headerlink" title="2.1 问题与解决"></a>2.1 问题与解决</h4><p>词法分析器思想并不难，核心思想就是不断扫描字符，然后进行状态转移。<br>但是存在一个问题，<strong>如何判断单词的开始和结束</strong>，该什么时候去记录单词，一开始的思路是按照空格划分，但是如<code>3+4</code>这样的字符串，没有空格，按照空格划分无法记录单词，而我们要能够区分<code>3</code>、<code>+</code>、<code>4</code>。于是转变思路，转移到终态就记录，能够应对上述例子，但是如<code>12</code>，按照这样的思想，会将<code>1</code>和<code>2</code>区分开来，不满足<strong>最长匹配原则</strong>。<br>经过思考，得出结论：<strong>当前状态接收当前字符无法转移的时候进行记录，记录时如果当前状态不在终态，证明当前单词不合法，就要进行出错处理</strong><br>另一个问题是如何区分两个ID类型的单词，如<code>for</code>和<code>int</code>按照DFA都会转移到状态ID并记录，它们是同一终态，但是是不同含义。<br>经过思考得出结论：<strong>建立符号表，如果是ID类型查询符号表，状态更新为查表得到的状态，如果查表失败就代表是不合法ID</strong></p>
<h4 id="2-2-输入"><a href="#2-2-输入" class="headerlink" title="2.2 输入"></a>2.2 输入</h4><p>词法分析器输入为一个字符串，其为程序文件的全部文本</p>
<h4 id="2-3-工作细节"><a href="#2-3-工作细节" class="headerlink" title="2.3 工作细节"></a>2.3 工作细节</h4><p>词法分析器工作流程如下：<br>将文本记为一整个字符串，对字符串从头开始扫描：</p>
<ol>
<li>读取当前扫描字符ch，当前单词tempStr+&#x3D;ch</li>
<li>若ch为空格或者回车（且是第一次遇到），record当前记号，重置所有标志，然后继续下一次扫描</li>
<li>如果出错标志为1或者注释标志为1，继续下一次扫描</li>
<li>若ch不为空格和回车，查询DFA进行状态转移，如果转移失败record该记号，tempStr-&#x3D;ch；如果转移成功，更新状态（如果当前状态是注释，注释标志置1）。接着继续下一次扫描</li>
</ol>
<p>record函数：<br>接收当前单词tempStr，和当前状态state，</p>
<ol>
<li>如果state是终态，查询符号表，如果命中，改变状态为查表所得状态，记录当前单词；如果未命中，令state&#x3D;-1，记录当前单词，然后reportError</li>
<li>如果state不是终态，记录当前单词，然后reportError</li>
</ol>
<p>reportError函数<br>接收当前单词tempStr、当前状态state、当前单词位于的行line、当前单词在行中的位置idx<br>打印报错信息：(line,idx,state对应的报错类型,tempStr)，报错标志置1<br>如：state&#x3D;-1，报错类型就是无法识别的ID</p>
<h4 id="2-4-输出"><a href="#2-4-输出" class="headerlink" title="2.4 输出"></a>2.4 输出</h4><p>输出为记号流，包含若干记号，每个记号是一个四元组（记号类型，单词，值，函数）<br>如：pi的记号是(CONST_FLOAT_ID,’pi’,3.1415926,None)</p>
<h2 id="三、语法分析"><a href="#三、语法分析" class="headerlink" title="三、语法分析"></a>三、语法分析</h2><h3 id="1-上下文无关法"><a href="#1-上下文无关法" class="headerlink" title="1. 上下文无关法"></a>1. 上下文无关法</h3><p>Program  →  { Statement SEMICO }<br>Statement → ORIGIN OriginStatment<br>| SCALE ScaleStatment<br>| ROT RotStatment<br>| FOR ForStatment<br>OriginStatment →IS<br>           L_BRACKET Expression COMMA Expression R_BRACKET<br>ScaleStatment  →IS<br>           L_BRACKET Expression COMMA Expression R_BRACKET<br>RotStatment →IS Expression<br>Expression→ Term   { ( PLUS | MINUS ) Term }<br>Term→ Factor { ( MUL | DIV ) Factor }<br>Factor→ ( PLUS | MINUS ) Factor | Component<br>Component→ Atom [ POWER Component ]<br>Atom →<br>(CONST_ID|CONST_FLOAT_ID|T)(PLUS|MINUS |MUL|DIV|POWER) Expression<br>      | FUNC L_BRACKET Expression R_BRACKET<br>      | L_BRACKET Expression R_BRACKET </p>
<p>该文法是EBNF文法，无二义性，无左递归左因子</p>
<h3 id="2-语法分析器"><a href="#2-语法分析器" class="headerlink" title="2. 语法分析器"></a>2. 语法分析器</h3><h4 id="2-1-问题与解决-1"><a href="#2-1-问题与解决-1" class="headerlink" title="2.1 问题与解决"></a>2.1 问题与解决</h4><h5 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h5><p>构建分析树非常简单，只需要将产生式右部全体作为产生式左部的孩子即可，但是构建<strong>语法树</strong>并不简单，如<code>3+2*1</code>该如何读入+时，将其作为3的父亲，读入2时又作为+的孩子，读入* 时又该如何改变树</p>
<p>查阅资料得到算法:</p>
<ol>
<li>如果当前读入的字符是<code>&#39;(&#39;</code>，添加一个新的节点作为当前节点的左子节点，并下降到左子节点处。</li>
<li>如果当前读入的字符在列表<code>[&#39;+&#39;, &#39;-&#39;, &#39;/&#39;, &#39;*&#39;]</code>中，将当前节点的根值设置为当前读入的字符。添加一个新的节点作为当前节点的右子节点，并下降到右子节点处。   </li>
<li>如果当前读入的字符是一个数字，将当前节点的根值设置为该数字，并返回到它的父节点。</li>
<li>如果当前读入的字符是’)’，返回当前节点的父节点。</li>
</ol>
<p><strong>缺陷</strong>：依赖括号处理优先级，如3+2*1就无法处理，读入2的时候当前节点在+号，再读入 * 时，该运算符就不知道该往哪放了</p>
<h5 id="改进思想"><a href="#改进思想" class="headerlink" title="改进思想"></a>改进思想</h5><p><strong>优先级的处理：</strong><br>在语法树中越靠近下的越优先计算，如<code>3+2*1</code>，读入 *  时，当前节点在+号，* 优先级高于+号，应该先计算 * 号，所以 * 号把+号的右孩子2夺过来，作为其左孩子，然后+号的右孩子改为 * 号<br>由上述过程可知，在一个语法树中，根节点永远是运算符，其左右孩子是一个表达式，<strong>在读到下一个运算符时，上一个运算符的右孩子被夹在了这两个运算符之间，如果这个运算符优先级比上一个更高，那么就要抢夺上一个运算符的右孩子，优先计算这一个运算符</strong>。<br>更进一步，如<code>4+3^2*1</code>，在读到 * 时，此时<code>3*2+1</code>，是+号的右孩子，2是 ^ 号的右孩子，^该抢夺哪一个右孩子？<strong>在语法树中，运算符永远比它的父亲优先级高，比他的孩子优先级低</strong>，<strong>所以应当向上和向右下搜索，直到找到一个节点</strong>，<strong>当前运算符优先级介于当前节点优先级和该节点右孩子优先级之间</strong><br>（为什么是右下，因为我们判断的是<strong>右孩子该跟谁结合的问题</strong>，而不可能去抢夺左孩子，左孩子和当前要判断的运算符是不邻接的）<br>特别的，<strong>操作数的优先级永远是最低的</strong>，因为它们永远是根节点</p>
<p><strong>结合性的处理：</strong><br>结合性的问题体现在两个操作符优先级相等的情况，<strong>左结合就是应当把两个操作符之间的表达式作为第一个操作符的右孩子，第二个操作符无法抢夺</strong>，如<code>3+2-1</code>就是先计算<code>3+2</code>在计算<code>-1</code>，右结合同理。此项目没有右结合的运算符，所以都按左结合处理</p>
<p><strong>括号的处理：</strong><br>语法树要求括号被隐含在树中，所以处理括号很重要。<code>3+(2-1)</code>中，( 的优先级比+号高，先计算<code>(2-1)</code>再计算<code>3+</code>，但是 ( 的优先级又比 - 号低，先计算<code>2-1</code>，再计算括号，<strong>在语法树中的体现是括号前的那个符号永远在括号上层，而括号内的表达式永远被封闭在括号下面</strong><br>括号的优先级比外面高，比里面低，所以需要特殊的算法，<strong>在遇到左括号时，意味着接下来要计算括号内的内容，此时所有构建要封闭在括号之下，所以给左括号设置最低的优先级，而遇到右括号时，意味着括号计算完毕，所有操作符都不能在进入括号之下，于是给左括号设置最高的优先级</strong></p>
<p><strong>函数的处理：</strong><br>此项目的表达式不仅有加减乘除，还有函数，<strong>函数也可以看作是一种操作符</strong>，其孩子是它的参数，所以函数按照操作符一样处理即可<br>另外还有语句如<code>scale is (a,b)</code>，类似于scale这种语句也可以看作是操作符，根节点是scale，左孩子是a，右孩子是b，一样操作即可。但是由于本项目没有语句的嵌套，所以没有必要给scale这种语句构建语法树，只需要作为另外的信息标注即可</p>
<h5 id="最终算法"><a href="#最终算法" class="headerlink" title="最终算法"></a>最终算法</h5><p>构建表达式的<strong>语法树算法</strong>如下：<br>现有表达式，从头开始对其扫描，当前字符为ch，当前节点为cNode，若：</p>
<ol>
<li>ch为左括号：cNode值设为左括号，优先级设置为最低，为cNode添加右孩子，cNode下降到该新节点</li>
<li>ch为右括号：cNode上升到其对应左括号节点，并将该节点优先级设置为最高</li>
<li>ch为操作数：cNode值设为此数，优先级设置为最低，cNode上升到父节点</li>
<li>ch为操作符：从cNode开始不断向上&#x2F;向右下搜索，直到搜索到某个节点tNode，ch优先级介于tNode优先级和tNode右孩子优先级之间，此时创建新节点nNode，其值为ch，优先级为ch优先级，其左孩子为tNode右孩子，并为其添加右孩子，令tNode右孩子为nNode， cNode更新为nNode右孩子</li>
</ol>
<p>最后删除该括号节点，其父亲继承其孩子</p>
<h4 id="2-2-输入-1"><a href="#2-2-输入-1" class="headerlink" title="2.2 输入"></a>2.2 输入</h4><p>输入为修饰后的记号流，修饰主要是删除记号流中记号类型（状态）不是终态的记号（代表出错记号）或者记号类型是注释的记号</p>
<h4 id="2-3-工作细节-1"><a href="#2-3-工作细节-1" class="headerlink" title="2.3 工作细节"></a>2.3 工作细节</h4><p>本项目采用的是递归下降分析器<br>构建的核心思想是，</p>
<ol>
<li>对于每个产生式Ei-&gt;…，引入函数Funi，其内容由产生式右部构成</li>
<li>函数内容中，遇见或，就引入if elif，遇见终结符就<br>加入到if的条件中，谋求记号和终结符的匹配，遇到非终结符就加入到if的内容中，进入非终结符对应的函数。如果或可以为空，那么else中就为空，否则else中报错（所有候选项都不匹配</li>
</ol>
<p>例：<br>Factor  	→ ( PLUS | MINUS ) Factor | Component<br>构建为如下函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">factor</span>(<span class="params">self</span>):  </span><br><span class="line">    <span class="keyword">if</span> self.token_list[self.idx][<span class="number">0</span>]==Token.PLUS.value <span class="keyword">or</span> self.token_list[self.idx][<span class="number">0</span>]==Token.MINUS.value:  </span><br><span class="line">        self.idx+=<span class="number">1</span>  </span><br><span class="line">        self.factor()  </span><br><span class="line">    <span class="keyword">elif</span> <span class="number">1</span>:  </span><br><span class="line">        self.component()  </span><br><span class="line">    <span class="keyword">else</span>:</span><br></pre></td></tr></table></figure>

<p>工作原理就是不断进入终结符的函数（展开终结符）谋求对非终结符的匹配，分析完毕后，检查出错标志，如果没出错，那么记录，如果出错，则不记录，并进行出错处理</p>
<p>出错处理：<br>函数的else语句中报错，则将出错标志置1，并return，在上层函数判断，如果出错标志为1，继续return，直到退出开始函数。<br>存在问题，报错该扫描到哪里为止，如果从出错位置开始的下一个位置继续进行语法分析，大概率仍然会报错，如<code>scale (1,1)</code>，按照上述思想会报六次错误。<br>如果将一整行抛弃掉那么又有可能会抛弃掉正确的语句<br>经过思考，得出结论：<br><strong>扫描到直到下一个记号可以合法的进行语法分析</strong>，如<code>scale (1,1); rot is 0</code>，报错会抛弃<code>(1,1);</code>，直到遇到<code>rot</code>才进行下一次语法分析</p>
<h4 id="2-4-输出-1"><a href="#2-4-输出-1" class="headerlink" title="2.4 输出"></a>2.4 输出</h4><p>输出是语法列表流，语法列表包括了语法的类型，语法的表达式的语法树<br>如<code>rot is 0;</code>的语法列表是[ROT,astTree]</p>
<h2 id="四、语义分析"><a href="#四、语义分析" class="headerlink" title="四、语义分析"></a>四、语义分析</h2><h3 id="1-问题与解决"><a href="#1-问题与解决" class="headerlink" title="1. 问题与解决"></a>1. 问题与解决</h3><p>如何计算一颗语法树？<br>先构建一个字典，其键为操作符，值为操作符对应的函数<br>然后构造函数calTree(tree)<br>calTree中：</p>
<ol>
<li>如果tree根节点为操作符，返回calTree(tree.left,tree.right)</li>
<li>如果tree根节点为操作数，返回该操作数（特别的，如果操作数为t，查询当前t设置的值，返回该值）</li>
</ol>
<h3 id="2-翻译器"><a href="#2-翻译器" class="headerlink" title="2. 翻译器"></a>2. 翻译器</h3><h4 id="2-1-输入"><a href="#2-1-输入" class="headerlink" title="2.1 输入"></a>2.1 输入</h4><p>语法列表流</p>
<h4 id="2-2-工作细节"><a href="#2-2-工作细节" class="headerlink" title="2.2 工作细节"></a>2.2 工作细节</h4><p>扫描语法列表流，若语法类型为</p>
<ol>
<li>ORIGIN：设置<br>origin_x&#x3D;calTree(tree1)<br>origin_y&#x3D;calTree(tree2)</li>
<li>SCALE：设置<br>scale_x&#x3D;calTree(tree1)<br>scale_y&#x3D;calTree(tree2)</li>
<li>ROT：设置 rot&#x3D;calTree(tree1)</li>
<li>FOR：设置<br>for_from&#x3D;calTree(tree1)<br>for_to&#x3D;calTree(tree2)<br>for_step&#x3D;calTree(tree3)<br>生成list&#x3D;[for_from:for_step:for_to]<br>对于list中的每个元素i，令t&#x3D;i，然后令<br>x&#x3D;calTree(tree4) * scale_x<br>y&#x3D;calTree(tree5) * scale_y<br>xx&#x3D;x * cos(rot)+y * sin(rot)-origin_x<br>yy&#x3D;y * cos(rot)-x * sin(rot)-origin_y<br>for_x.appen(xx)<br>for_y.appen(yy))<br>对于xx，yy中的每个元素xi，yi，绘制点(xi,yi)</li>
</ol>
<p>出错处理：<br>在操作符对应的函数中进行出错处理，如div函数，如果除数为0，返回报错语句，上层检测到返回值不是一个数字，则继续返回，直到退出函数，并终止程序。</p>
<h4 id="2-3-输出"><a href="#2-3-输出" class="headerlink" title="2.3 输出"></a>2.3 输出</h4><p>输出为绘制的图</p>
<h2 id="五、结果展示"><a href="#五、结果展示" class="headerlink" title="五、结果展示"></a>五、结果展示</h2><p>源程序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">origin is (0, 0);</span><br><span class="line">scale is (1, 1);</span><br><span class="line">for t from e to 10 step 0.1 draw(t, ln(t));</span><br><span class="line">scale is (1, 1);</span><br><span class="line">for t from 0 to 2 step 0.1 draw(t, t**2);</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<p><img src="/imgs/compilerProject/1703432926195.jpg" alt="图片"></p>
<hr>
<p><span style="color: gray;">结语：<br>&emsp;&emsp;</span></p>
<hr>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 21009200039@stu.xidian.edu.cn </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">💰</a>
</p>






    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2017 弦上的箭
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







<div id="musicMouseDrag" style="position:fixed; z-index: 9999; bottom: 0; right: 0;">
    <div id="musicDragArea" style="position: absolute; top: 0; left: 0; width: 100%;height: 10px;cursor: move; z-index: 10;"></div>
    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=230 height=75 src="//music.163.com/outchain/player?type=2&id=2059532170&auto=0&height=66"></iframe>
</div>

<script>
    var $DOC = $(document)
    $('#musicMouseDrag').on('mousedown', function (e) {
      // 阻止文本选中
      $DOC.bind("selectstart", function () {
        return false;
      });
      $('#musicDragArea').css('height', '100%');
      var $moveTarget = $('#musicMouseDrag');
      $moveTarget.css('border', '1px dashed grey')
      var div_x = e.pageX - $moveTarget.offset().left;
      var div_y = e.pageY - $moveTarget.offset().top;
      $DOC.on('mousemove', function (e) {
        var targetX = e.pageX - div_x;
        var targetY = e.pageY - div_y;
        targetX = targetX < 0 ? 0 : (targetX + $moveTarget.outerWidth() >= window.innerWidth) ? window.innerWidth - $moveTarget.outerWidth() : targetX;
        targetY = targetY < 0 ? 0 : (targetY + $moveTarget.outerHeight() >= window.innerHeight) ? window.innerHeight - $moveTarget.outerHeight() : targetY;
        $moveTarget.css({'left': targetX + 'px', 'top': targetY + 'px', 'bottom': 'inherit', 'right': 'inherit'})
      }).on('mouseup', function () {
        $DOC.unbind("selectstart");
        $DOC.off('mousemove')
        $DOC.off('mouseup')
        $moveTarget.css('border', 'none')
        $('#musicDragArea').css('height', '10px');
      })
    })
</script>
</html>
